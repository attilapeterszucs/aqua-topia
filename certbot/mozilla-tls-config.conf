# HTF 2025 Team 8 - Mozilla Modern TLS Configuration
# Based on: https://wiki.mozilla.org/Security/Server_Side_TLS
# Profile: Modern (TLS 1.3 only)
# Last Updated: 2025
# For use with: nginx, Apache, HAProxy, or other reverse proxies

# ============================================
# TLS Protocol Configuration
# ============================================
# Enable TLS 1.3 only (most secure)
# Minimum TLS Version: 1.3
# Maximum TLS Version: 1.3

# For nginx:
# ssl_protocols TLSv1.3;

# For Apache 2.4.38+:
# SSLProtocol -all +TLSv1.3

# For HAProxy 2.2+:
# ssl-min-ver TLSv1.3
# ssl-max-ver TLSv1.3

# ============================================
# Cipher Suites (TLS 1.3)
# ============================================
# TLS 1.3 cipher suites (order matters for preference)
# Recommended cipher suites:
# - TLS_AES_128_GCM_SHA256
# - TLS_AES_256_GCM_SHA384
# - TLS_CHACHA20_POLY1305_SHA256

# For nginx:
# ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256';
# ssl_prefer_server_ciphers off;

# For Apache:
# SSLCipherSuite TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
# SSLHonorCipherOrder off

# For HAProxy:
# ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256

# ============================================
# Certificate Configuration
# ============================================
# Certificate paths (Let's Encrypt)
# ssl_certificate /etc/letsencrypt/live/www8.htf25.qubr.be/fullchain.pem;
# ssl_certificate_key /etc/letsencrypt/live/www8.htf25.qubr.be/privkey.pem;
# ssl_trusted_certificate /etc/letsencrypt/live/www8.htf25.qubr.be/chain.pem;

# ============================================
# Session Configuration
# ============================================
# Session cache and timeout
# For nginx:
# ssl_session_cache shared:SSL:10m;
# ssl_session_timeout 1d;
# ssl_session_tickets off;

# For Apache:
# SSLSessionCache shmcb:/var/cache/apache2/ssl_scache(512000)
# SSLSessionCacheTimeout 86400
# SSLSessionTickets off

# ============================================
# OCSP Stapling
# ============================================
# Enable OCSP stapling for improved performance and privacy
# For nginx:
# ssl_stapling on;
# ssl_stapling_verify on;
# resolver 1.1.1.1 1.0.0.1 valid=300s;
# resolver_timeout 5s;

# For Apache:
# SSLUseStapling on
# SSLStaplingCache shmcb:/var/run/ocsp(128000)

# ============================================
# Security Headers
# ============================================
# HTTP Strict Transport Security (HSTS)
# Enforces HTTPS for 2 years, including subdomains
# add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;

# For Apache:
# Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"

# Additional security headers
# add_header X-Frame-Options "SAMEORIGIN" always;
# add_header X-Content-Type-Options "nosniff" always;
# add_header X-XSS-Protection "1; mode=block" always;
# add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# ============================================
# Diffie-Hellman Parameters
# ============================================
# Not required for TLS 1.3 only configuration
# (TLS 1.3 removed support for static DH)

# ============================================
# Complete nginx Example
# ============================================
# server {
#     listen 443 ssl http2;
#     listen [::]:443 ssl http2;
#     server_name www8.htf25.qubr.be;
#
#     # TLS Configuration
#     ssl_protocols TLSv1.3;
#     ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256';
#     ssl_prefer_server_ciphers off;
#
#     # Certificates
#     ssl_certificate /etc/letsencrypt/live/www8.htf25.qubr.be/fullchain.pem;
#     ssl_certificate_key /etc/letsencrypt/live/www8.htf25.qubr.be/privkey.pem;
#     ssl_trusted_certificate /etc/letsencrypt/live/www8.htf25.qubr.be/chain.pem;
#
#     # Session
#     ssl_session_cache shared:SSL:10m;
#     ssl_session_timeout 1d;
#     ssl_session_tickets off;
#
#     # OCSP Stapling
#     ssl_stapling on;
#     ssl_stapling_verify on;
#     resolver 1.1.1.1 1.0.0.1 valid=300s;
#     resolver_timeout 5s;
#
#     # Security Headers
#     add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
#     add_header X-Frame-Options "SAMEORIGIN" always;
#     add_header X-Content-Type-Options "nosniff" always;
#     add_header X-XSS-Protection "1; mode=block" always;
#
#     # Proxy to application
#     location / {
#         proxy_pass http://localhost:8080;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#     }
# }

# ============================================
# Complete Apache Example
# ============================================
# <VirtualHost *:443>
#     ServerName www8.htf25.qubr.be
#
#     # TLS Configuration
#     SSLEngine on
#     SSLProtocol -all +TLSv1.3
#     SSLCipherSuite TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
#     SSLHonorCipherOrder off
#
#     # Certificates
#     SSLCertificateFile /etc/letsencrypt/live/www8.htf25.qubr.be/fullchain.pem
#     SSLCertificateKeyFile /etc/letsencrypt/live/www8.htf25.qubr.be/privkey.pem
#
#     # OCSP Stapling
#     SSLUseStapling on
#     SSLStaplingCache shmcb:/var/run/ocsp(128000)
#
#     # Security Headers
#     Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains; preload"
#     Header always set X-Frame-Options "SAMEORIGIN"
#     Header always set X-Content-Type-Options "nosniff"
#
#     # Proxy to application
#     ProxyPass / http://localhost:8080/
#     ProxyPassReverse / http://localhost:8080/
# </VirtualHost>
